library(DOSE)
library(org.Hs.eg.db)
library(topGO)
library(clusterProfiler)
library(pathview)
library(ggplot2)

organism = "org.Hs.eg.db"
library(organism, character.only = TRUE)



gene_names <- rownames(luad_cBio_data)

genes_cluster1 <- gene_names[row_clusters == 1]
genes_cluster2 <- gene_names[row_clusters == 2]
genes_cluster3 <- gene_names[row_clusters == 3]
genes_cluster4 <- gene_names[row_clusters == 4]



data(geneList, package="DOSE")
gene <- names(geneList)[abs(geneList) > 2]
gene.df <- bitr(gene, fromType = "ENTREZID", toType = c("ENSEMBL", "SYMBOL"), OrgDb = org.Hs.eg.db)
head(gene.df,2)






#genes_cluster1
degs.df = bitr(genes_cluster1, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)

degs_kegg <- enrichKEGG(gene = degs.df$ENTREZID,
                              organism     = 'hsa',
                              pvalueCutoff = 0.05)
degs_kegg <- setReadable(degs_kegg,'org.Hs.eg.db','ENTREZID')
head(degs_kegg)



degs_GO <- enrichGO(gene          = degs.df$ENTREZID,
                    OrgDb         = org.Hs.eg.db,
                    keyType       = "ENTREZID",
                    ont           = "BP",  # for Biological Processes
                    pAdjustMethod = "BH",
                    pvalueCutoff  = 0.1,
                    qvalueCutoff  = 0.1)
degs_GO <- as.data.frame(degs_GO)
degs_GO




#genes_cluster2
degs.df = bitr(genes_cluster2, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)

degs_kegg <- enrichKEGG(gene = degs.df$ENTREZID,
                        organism     = 'hsa',
                        pvalueCutoff = 0.05)
degs_kegg <- setReadable(degs_kegg,'org.Hs.eg.db','ENTREZID')
head(degs_kegg)



degs_GO <- enrichGO(gene          = degs.df$ENTREZID,
                    OrgDb         = org.Hs.eg.db,
                    keyType       = "ENTREZID",
                    ont           = "BP",  # for Biological Processes
                    pAdjustMethod = "BH",
                    pvalueCutoff  = 0.05,
                    qvalueCutoff  = 0.05)
degs_GO <- as.data.frame(degs_GO)
degs_GO
#barplot(degs_GO, showCategory=10)



#genes_cluster3
degs.df = bitr(genes_cluster3, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)

degs_kegg <- enrichKEGG(gene = degs.df$ENTREZID,
                        organism     = 'hsa',
                        pvalueCutoff = 0.05)
degs_kegg <- setReadable(degs_kegg,'org.Hs.eg.db','ENTREZID')
head(degs_kegg)



degs_GO <- enrichGO(gene          = degs.df$ENTREZID,
                    OrgDb         = org.Hs.eg.db,
                    keyType       = "ENTREZID",
                    ont           = "BP",  # for Biological Processes
                    pAdjustMethod = "BH",
                    pvalueCutoff  = 0.1, 
                    qvalueCutoff  = 0.1)
degs_GO <- as.data.frame(degs_GO)
degs_GO



#genes_cluster4
degs.df = bitr(genes_cluster4, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = org.Hs.eg.db)

degs_kegg <- enrichKEGG(gene = degs.df$ENTREZID,
                        organism     = 'hsa',
                        pvalueCutoff = 0.1)
degs_kegg <- setReadable(degs_kegg,'org.Hs.eg.db','ENTREZID')
head(degs_kegg)



degs_GO <- enrichGO(gene          = degs.df$ENTREZID,
                    OrgDb         = org.Hs.eg.db,
                    keyType       = "ENTREZID",
                    ont           = "BP",  # for Biological Processes
                    pAdjustMethod = "BH",
                    pvalueCutoff  = 0.1,
                    qvalueCutoff  = 0.1)
degs_GO <- as.data.frame(degs_GO)
degs_GO




